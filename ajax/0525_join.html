<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Join</title>
<!-- <link rel="stylesheet" href="../css/public_blue.css"> -->
<link rel="shortcut icon" type="image/x-icon" href="../images/J.png"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="../js/jquery.serializejson.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
<script>
$(function(){
	$('#checkId').on('click', function(){
		//입력한 id를 가져온다 - 공백체크
		idValue = $('#id').val().trim();
		
		if(idValue.length < 1){
			alert("아이디를 입력");
			return false;
		}
		
		//요청과 응답
		$.ajax({
			url : '/JQPro/IdCheck.do', //이게 서블릿. /안 붙이면 404 오류 발생 (페이지가 없어서)
			type : 'post',
			data : 'id=' + $('#id').val().trim(), //'id='는 idCheck.java에서 request.getParameter("id")와 같아야 함
// 			data : { "id" : $('#id').val().trim()}, //이렇게 써도 됨
			success : function(result){
				$('#spanId').html(result.sw).css('color', 'red');
			},
			error : function(xmlR){
				alert("상태 : " + xmlR.status);
			},
			dataType : 'json'
			
		})
// 			console.log(data);
		
	})
	
	
	//우편번호 검색
	$('#zipbtn').on('click', function(){
		//새로운 창 열기
		window.open("searchZip.html", "우편번호찾기", "width=640 height=800 min-width=640"); //파일, 논리적이름(보이지 않음) -> 대신에 _blank 타입을 써도 됨, 크기
	})
	
	//전송 제출 - 저장하기
	$('form').on('submit', function(){
// 		alert('전송');

		//입력한 모든 값을 가져온다
	/*
		$('#id').val().trim();
		$('#name').val().trim();
		$('#pw').val().trim();
		$('#email').val().trim();
		$('#bir').val().trim();
		$('#hp').val().trim();
		$('#zip').val().trim();
		$('#add1').val().trim();
		$('#add2').val().trim();
		
		//userData 만드는 방법
		//1) 객체 타입으로 작성 : serializeJSON
		userData = {
				"id" : $('#id').val().trim(),
				"name" : $('#name').val().trim(),
				"pw" : $('#pw').val().trim(),
				"email" : $('#email').val().trim(),
				"bir" : $('#bir').val().trim(),
				"hp" : $('#hp').val().trim(),
				"zip" : $('#zip').val().trim(),
				"add1" : $('#add1').val().trim(),
				"add2" : $('#add2').val().trim()
		}
	*/
		//2) String 타입으로 작성 : serialize
// 		userData = "id=" + $('#id').val().trim() + "&name=" + $('#name').val().trim() + "&pw" + $('#pw').val().trim() ...

		//3) 직렬화 : 데이터를 한 덩어리로 모아서 보냄
		userData1 = $('form').serialize();
		userData2 = $('form').serializeArray();
		userData3 = $('form').serializeJSON();
		
		console.log(userData1);
		console.log(userData2);
		console.log(userData3);
		
		//클라이언트 요청 -> 서버로 전송 - controller가 요청 받음 - 
		$.ajax({
			url : '/JQPro/insertMember.do',
			type : 'post',
			data : userData3,
			success : function(res){
				$('#spanId').html(res.sw)
			},
			error : function(xhr){
				alert("상태 : " + xhr.status);
			},
			dataType : 'json'
		})
		
	})
})
</script>
<style type="text/css">
@import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Dongle:wght@300;400&family=Gowun+Batang&display=swap');
body *{
	font-family: 'Gowun Batang', serif;
}
pre{
	min-width : 1000px;
	font-family: 'Gowun Batang', serif;
	font-weight : bold;
	font-size : 1.2em;
	color : #282828;
	
	/* 파란버전 */
	border : 5px dotted #96A5FF; 
 	border-top : 5px double #96A5FF;
 	border-bottom : 5px double #96A5FF;
	background : #E8F5FF;
	padding : 30px;
}
</style>
</head>
<body>
<pre>
json 주석은 &lt;% //로 주석달기%>

mvc에서 v는 출력하기 위한 로직만 존재(jsp사용)
c에서 자바 처리(서블릿 사용)
m은 데이터를 주고받기 위해
좁은 의미로 vo가 모델, 넓은 의미로 service와 dao도 포함
자바 로직 처리와 출력 처리 분리를 위해 mvc 패턴을 이용하게 됨

서블릿 : 웹(톰캣)에서 실행시키는 자바 프로그램
</pre>
<div class="container">
  <h2>Stacked form</h2>
  <form onsubmit ="return false;">
    <div class="form-group">
      <label for="id">아이디:</label>
      <input type="button" id="checkId" value="중복검사" class='btn btn-warning btn-lg'>
      <input type="text" class="form-control" id="id" placeholder="Enter id" name="mem_id">
      <span id="spanId"></span>
    </div>
    <div class="form-group">
      <label for="pw">비밀번호:</label>
      <input type="password" class="form-control" id="pw" placeholder="Enter password" name="mem_pass" autoComplete="on">
    </div>
    <div class="form-group">
      <label for="name">이름:</label>
      <input type="text" class="form-control" id="name" placeholder="Enter name" name="mem_name">
    </div>
    <div class="form-group">
      <label for="email">이메일:</label>
      <input type="text" class="form-control" id="email" placeholder="Enter email" name="mem_email">
    </div>
    <div class="form-group">
      <label for="hp">전화번호:</label>
      <input type="text" class="form-control" id="hp" placeholder="Enter hp" name="mem_hp">
    </div>
    <div class="form-group">
      <label for="bir">생일:</label>
      <input type="date" class="form-control" id="bir" placeholder="Enter birth" name="mem_bir">
    </div>
    <div class="form-group">
      <label for="zip">우편번호:</label>
      <input type='button' value='번호검색' id='zipbtn' class='btn btn-warning btn-sm'>
      <input type="text" class="form-control" id="zip" placeholder="Enter zip" name="mem_zip">
    </div>
    <div class="form-group">
      <label for="add1">주소:</label>
      <input type="text" class="form-control" id="add1" placeholder="Enter add1" name="mem_add1">
    </div>
    <div class="form-group">
      <label for="add2">상세주소:</label>
      <input type="text" class="form-control" id="add2" placeholder="Enter add2" name="mem_add2">
    </div>
    <button type="submit" class="btn btn-primary"><span class="spinner-border spinner-border-sm"></span>Submit</button>
  </form>
</div>
</body>
</html>
